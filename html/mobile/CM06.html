<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>신용솔루션 - 질문등록</title>
    <link rel="stylesheet" href="../../css/style.css">
</head>
<body>
<div class="wrap">
    <div class="header">
        <button type="button" class="btnBack"><span class="blind">이전</span></button>
        <h1 class="headerTitle">신용솔루션</h1>
        <button type="button" class="btnAlarm active"><span class="blind">알람</span></button>
        <button type="button" class="btnMenu"><span class="blind">전체메뉴</span></button>
    </div>
    <div class="container">
        <div class="registerQuestion">
            <div class="selectWrap">
                <div class="selectBox">
                    <label for="selectTest1-1" class="blind">상담분약 선택</label>
                    <select name="" id="selectTest1-1">
                        <option value="" disabled selected>상담분야 선택</option>
                        <option value="">전문분야 선택</option>
                    </select>
                </div>
                <div class="selectBox">
                    <label for="selectTest1-2" class="blind">상담사 선택[필수]</label>
                    <select name="" id="selectTest1-2">
                        <option value="" disabled selected>상담사 선택[필수]</option>
                        <option value="">상담분야 선택</option>
                    </select>
                </div>
            </div>
            <div class="inputWrap mgTop16">
                <label for="title" class="blind">제목 타이틀</label>
                <input type="text" name="" id="title" placeholder="제목을 입력해주세요.(100자 이내)">
            </div>
            <div class="textStyle">
                <label for="textarea01" class="blind">질문 등록 내용</label>
                <textarea name="" id="textarea01" cols="30" rows="10" placeholder="내용을 입력해 주세요.&#13;&#10;(최소 20자 이상 1,000자까지 입력 가능합니다)&#13;&#10;&#13;&#10;※ 신용회복과 관련되지 않은 질문 시 해당 질문&#13;&#10;은 관리자에 의해서 삭제될 수 있습니다."></textarea>
            </div>
            <div class="textCount"><span class="num">0</span><span class="totalNum">1,000<em>자</em></span></div>
            <div class="fileWrap">
                <div class="fileBox">
                    <input class="uploadName" value="파일첨부" disabled="disabled">
                    <label for="fileEx"><span class="blind">파일첨부</span></label>
                    <div class="counting">
                        <span class="count">0</span><span class="total">1</span>
                    </div>
                    <input type="file" id="fileEx">
                </div>
                <!--<div class="fileList">
                    <div class="item">
                        <button type="button" class="btnDel"><span class="blind">삭제</span></button>
                        <img src="../../images/temp/thumbnail_04.png" alt="임시 이미지01">
                    </div>
                </div>-->
            </div>
            <div class="fileText">JPEG, JPG, PNG 사진 최대 <span class="number">1</span>개까지 등록 가능(선택)</div>
        </div>
    </div>
    <div class="btnWrap fixedBtm">
        <button type="button" class="btn btn-d" disabled><span>등록하기</span></button>
    </div>
</div>

<script src="../../js/lib/jquery-3.6.0.min.js"></script>
<script src="../../js/common.js"></script>
<script>
    /* 파일첨부 클릭 시 */
    const imgTarget = $('#fileEx');

    imgTarget.on('change', function(){
        const parent = $(this).closest('.fileWrap');
        parent.children('.uploadDisplay').remove();
        let num = 0;

       if(window.FileReader) {
           if (!$(this)[0].files[0].type.match(/image\//)) return;

           const reader = new FileReader();


           reader.onload = function (e) {
               const src = e.target.result;
               parent.append('<div class="uploadDisplay"><div class="uploadThumbWrap"><img src="'+src+'" class="uploadThumb"><button type="button" class="btnDel"><span class="blind">삭제</span></button></div></div>').on('click','.btnDel',function(){
                   $('.uploadDisplay').remove();
                   num = $('.uploadDisplay').length;
                   $('.counting .count').text(num);
               });
               num = $('.uploadDisplay').length;
               $('.counting .count').text(num);
           }
           reader.readAsDataURL($(this)[0].files[0]);


       } else {
           $(this)[0].select();
           $(this)[0].blur();
           const imgSrc = document.selection.createRange().text;
           parent.append('<div class="uploadDisplay"><div class="uploadThumbWrap"><img class="uploadThumb"><button type="button" class="btnDel"><span class="blind">삭제</span></button></div></div>').on('click','.btnDel',function(){
               $('.uploadDisplay').remove();
           });
           const img = $(this).siblings('.uploadDisplay').find('img');
           img[0].style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(enable='true',sizingMethod='scale',src=\""+imgSrc+"\")";
       };

       //$(this).siblings('.uploadName').val(filename);
    });



    /* 퍼블에서만 사용하는 스크립트입니다. */
    $("#textarea01").keyup(function(){
        if($(this).val().length > 0) {
            $('.btnWrap button').attr('disabled',false);
            $(".num").text($(this).val().length).css({"color" : "#000"});
        } else {
            $('.btnWrap button').attr('disabled',true);
            $(".num").text($(this).val().length).css({"color" : "#757575"});
        }
    });

    $('.btnDel').on('click',function(){
        console.log('111111111');
        $('.uploadDisplay').remove();
    });
</script>
</body>
</html>